@{
	ViewBag.Title = "Search";
	Layout = "~/Views/Shared/_Layout.cshtml";
}
@model Services.Repository.RecipeListDisplayWithPaging

<div id="page-title" class="padding-tb-30px gradient-white text-center">

	<h1 class="font-weight-300">Search Results for: @ViewBag.keyword</h1>

</div>

<div class="container">
	<div class="margin-bottom-60px">
		<div class="listing-search box-shadow">
			<form class="row no-gutters" action="/Plan/SearchKeyWordFitler?slotNow=@ViewBag.slotNow&week=@ViewBag.Week">
				
				<input class="listing-form first" type="hidden"
					   value="@ViewBag.slotNow" name="slotNow" id="postTitle">

				<input class="listing-form first" type="hidden"
					   value="@ViewBag.week" name="week" id="postTitle">

				<div class="col-md-4">
					<div class="keywords">
						<input class="listing-form first" type="text" placeholder="Keywords..." value="@ViewBag.keyword" name="keyword" id="postTitle">
					</div>
				</div>
				<div class="col-md-4">
					<div class="categories dropdown">
						<select class="listing-form d-block text-nowrap" id="dropdownMenu2" name="filter">
							<option value="1">Top Share</option>
							<option value="2">Date Recent</option>
							<option value="3">A-Z</option>
							
						</select>
					</div>
					<script>
						// Replace "selectedValue" with the actual variable name in your JavaScript code
						var selectedValue = @ViewBag.filter; // Example value

						// Set the value of the select element to the desired value
						document.getElementById("dropdownMenu2").value = selectedValue.toString();
					</script>
				</div>
				<div class="col-md-4">
					<button class="listing-bottom background-second-color box-shadow hvr-bounce-to-right" type="submit">Search Now</button>
				</div>
			</form>
		</div>
	</div>
</div>


<div class="container">
	<!-- item -->
	@if (Model.Recipes != null && ViewBag.notfound != "")
	{
		@foreach (var item in Model.Recipes)
		{

			<div class="margin-bottom-30px">
				<div class="background-white thum-hover box-shadow hvr-float full-width">
					<div class="float-md-left margin-30px thum-xs">
						<img class="width-150px" src="@item.Image" alt="">
					</div>

					<div class="padding-25px">
						<div class="rating">
							<ul>
								<li class="@((item.AvgRate >= 1) ? "active" : "")"></li>
								<li class="@((item.AvgRate >= 2) ? "active" : "")"></li>
								<li class="@((item.AvgRate >= 3) ? "active" : "")"></li>
								<li class="@((item.AvgRate >= 4) ? "active" : "")"></li>
								<li class="@((item.AvgRate >= 5) ? "active" : "")"></li>
							</ul>
						</div>
						<h3><a href="" class="d-block text-dark text-capitalize text-medium margin-tb-15px">@item.Title</a></h3>
						<hr>
						<div class="row no-gutters">
							<div class="col-4 text-left"><a href="/Plan/AddToSlot/?slotNow=@ViewBag.slotNow&recipeID=@item.RecipeId&week=@ViewBag.week" class="text-red"><i class="far fa-plus"></i> Add to Plan</a></div>
							<div class="col-8 text-right"><a href="/Plan/AddToSlot/?slotNow=@ViewBag.slotNow&recipeID=@item.RecipeId&week=@ViewBag.week" class="text-grey-2"><i class="fas fa-users"></i> @item.NumberShare</a></div>
						</div>
					</div>
					<div class="clearfix"></div>
				</div>
			</div>
		}

		//paging
		<div class="col-12 pb-1">
			<nav aria-label="Page navigation">
				<ul class="pagination justify-content-center mb-3">


					@if (Model.PagingInfo.CurrentPage != 1)
					{
						<li class="page-item ">
							<a class="page-link" href="/Plan/SearchKeyWordFitler/?productPage=@(Model.PagingInfo.CurrentPage-1)&keyword=@ViewBag.keyword&filter=@ViewBag.filter&slotNow=@ViewBag.slotNow&week=@ViewBag.week" aria-label="Previous">
								<span aria-hidden="true">&laquo;</span>
								<span class="sr-only">Previous</span>
							</a>
						</li>
					}
					else
					{
						<li class="page-item disabled">
							<a class="page-link" href="#" aria-label="Previous">
								<span aria-hidden="true">&laquo;</span>
								<span class="sr-only">Previous</span>
							</a>
						</li>
					}

					@for (int i = 1; i <= Model.PagingInfo.TotalPages; i++)
					{
						<li class="page-item">
							<a class="page-link" href="/Plan/SearchKeyWordFitler/?productPage=@i&keyword=@ViewBag.keyword&filter=@ViewBag.filter&slotNow=@ViewBag.slotNow&week=@ViewBag.week"
							   style="@((Model.PagingInfo.CurrentPage == i) ? "background-color: blue; color: white;" : "")">@i</a>
						</li>

					}
					@if (Model.PagingInfo.CurrentPage != Model.PagingInfo.TotalPages)
					{
						<li class="page-item">
							<a class="page-link" href="/Plan/SearchKeyWordFitler/?productPage=@(Model.PagingInfo.CurrentPage+1)&keyword=@ViewBag.keyword&filter=@ViewBag.filter&slotNow=@ViewBag.slotNow&week=@ViewBag.week" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
								<span class="sr-only">Next</span>
							</a>
						</li>
					}
					else
					{
						<li class="page-item disabled">
							<a class="page-link" href="#" aria-label="Next">
								<span aria-hidden="true">&raquo;</span>
								<span class="sr-only">Next</span>
							</a>
						</li>
					}

				</ul>
			</nav>
		</div>
	}
	else
	{
		<h1 color="red">@ViewBag.notfound</h1>
	}
	<!-- // item -->


	@*<div class="text-center">
		<a href="#" class="btn box-shadow margin-bottom-80px padding-tb-10px btn-sm border-2 border-radius-30 btn-inline-block width-210px background-dark text-white">Loading more</a>
	</div>*@



</div>

@section Scripts {
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
	<script>

		(function ($) {
			$(document).ready(function () {
				$("#postTitle").autocomplete({
					source: '/api/postapi/search1'

				});

			});
		})(jQuery);
	</script>
	}
<script>
	// Lấy đối tượng button Previous
	var prevBtn = document.getElementById("prevBtn");

	// Gán sự kiện click cho button Previous
	prevBtn.addEventListener("click", function () {
		var currentPage = @Model.PagingInfo.CurrentPage;
		if (currentPage > 1) {
			var prevPage = currentPage - 1;
			window.location.href = "/Plan/SearchKeyWordFitler/?productPage=" + prevPage + "&keyword=@ViewBag.keyword&filter=@ViewBag.filter";
		}
	});
</script>